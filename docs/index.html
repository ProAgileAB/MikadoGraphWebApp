<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Title</title><style>#open-button{display:none}#graph:empty~#open-button{display:inline-block}#example{text-align:center;display:none}#graph:empty~#example{display:block}</style></head><body style="height:100%"> <div id="graph" style="text-align:center;height:100%"></div> <button id="open-button" onclick="getFile(render)">Choose Mikado file (.mikado)</button> <script type="module">var e;e=function(){function e(t,r,n,o){this.message=t,this.expected=r,this.found=n,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){var r,n={literal:function(e){return'"'+a(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function o(e){return e.charCodeAt(0).toString(16).toUpperCase()}function a(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+o(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+o(e)}))}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+o(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+o(e)}))}return"Expected "+function(e){var t,r,o,a=new Array(e.length);for(t=0;t<e.length;t++)a[t]=(o=e[t],n[o.type](o));if(a.sort(),a.length>0){for(t=1,r=1;t<a.length;t++)a[t-1]!==a[t]&&(a[r]=a[t],r++);a.length=r}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(e)+" but "+(((r=t)?'"'+a(r)+'"':"end of input")+" found.")},{SyntaxError:e,parse:function(t,r){r=void 0!==r?r:{};var n,o={},a={Expression:B},i=B,c="Goal",u=S("Goal",!1),l=" needs ",s=S(" needs ",!1),f="Done: ",p=S("Done: ",!1),h="\n",d=S("\n",!1),g=", ",x=S(", ",!1),y=function(e,t){return t},A=/^[a-zA-Z]/,m=T([["a","z"],["A","Z"]],!1,!1),v=/^[()a-zA-Z ">=.+]/,w=T(["(",")",["a","z"],["A","Z"]," ",'"',">","=",".","+"],!1,!1),E=z("whitespace"),b=/^[ \t\n\r]/,F=T([" ","\t","\n","\r"],!1,!1),C=0,$=[{line:1,column:1}],k=0,j=[],G=0;if("startRule"in r){if(!(r.startRule in a))throw new Error("Can't start parsing from rule \""+r.startRule+'".');i=a[r.startRule]}function S(e,t){return{type:"literal",text:e,ignoreCase:t}}function T(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function z(e){return{type:"other",description:e}}function I(e){var r,n=$[e];if(n)return n;for(r=e-1;!$[r];)r--;for(n={line:(n=$[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return $[e]=n,n}function M(e,t){var r=I(e),n=I(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function R(e){C<k||(C>k&&(k=C,j=[]),j.push(e))}function Z(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}function B(){var e,t;if(e=[],(t=D())===o&&(t=O())===o&&(t=P()),t!==o)for(;t!==o;)e.push(t),(t=D())===o&&(t=O())===o&&(t=P());else e=o;return e}function D(){var e,r,n;return e=C,t.substr(C,4)===c?(r=c,C+=4):(r=o,0===G&&R(u)),r!==o&&(n=q())!==o?(e,e=r={goal:n}):(C=e,e=o),e}function O(){var e,r,n,a,i;return e=C,r=function(){var e,r,n,a,i,c;if(e=C,(r=U())!==o){for(n=[],a=C,t.substr(C,2)===g?(i=g,C+=2):(i=o,0===G&&R(x)),i!==o&&(c=U())!==o?(a,a=i=y(0,c)):(C=a,a=o);a!==o;)n.push(a),a=C,t.substr(C,2)===g?(i=g,C+=2):(i=o,0===G&&R(x)),i!==o&&(c=U())!==o?(a,a=i=y(0,c)):(C=a,a=o);n!==o?(e,u=r,(l=n).push(u),e=r=l):(C=e,e=o)}else C=e,e=o;var u,l;return e}(),r!==o?(t.substr(C,7)===l?(n=l,C+=7):(n=o,0===G&&R(s)),n!==o&&(a=U())!==o&&(i=q())!==o?(e,e=r={steps:r,needs:a,text:i}):(C=e,e=o)):(C=e,e=o),e}function P(){var e,r,n,a,i;if(e=C,t.substr(C,6)===f?(r=f,C+=6):(r=o,0===G&&R(p)),r!==o)if((n=U())!==o){for(a=[],10===t.charCodeAt(C)?(i=h,C++):(i=o,0===G&&R(d));i!==o;)a.push(i),10===t.charCodeAt(C)?(i=h,C++):(i=o,0===G&&R(d));a!==o?(e,e=r={done:n}):(C=e,e=o)}else C=e,e=o;else C=e,e=o;return e}function U(){var e,r,n;if(e=C,r=[],A.test(t.charAt(C))?(n=t.charAt(C),C++):(n=o,0===G&&R(m)),n!==o)for(;n!==o;)r.push(n),A.test(t.charAt(C))?(n=t.charAt(C),C++):(n=o,0===G&&R(m));else r=o;return r!==o&&(e,r=r.join("")),e=r}function q(){var e,r,n,a,i;if(e=C,10===t.charCodeAt(C)?(r=h,C++):(r=o,0===G&&R(d)),r!==o)if(n=function(){var e,r;G++,e=[],b.test(t.charAt(C))?(r=t.charAt(C),C++):(r=o,0===G&&R(F));for(;r!==o;)e.push(r),b.test(t.charAt(C))?(r=t.charAt(C),C++):(r=o,0===G&&R(F));G--,e===o&&(r=o,0===G&&R(E));return e}(),n!==o){if(a=[],v.test(t.charAt(C))?(i=t.charAt(C),C++):(i=o,0===G&&R(w)),i!==o)for(;i!==o;)a.push(i),v.test(t.charAt(C))?(i=t.charAt(C),C++):(i=o,0===G&&R(w));else a=o;a!==o?(10===t.charCodeAt(C)?(i=h,C++):(i=o,0===G&&R(d)),i!==o?(e,e=r=a.join("")):(C=e,e=o)):(C=e,e=o)}else C=e,e=o;else C=e,e=o;return e}if((n=i())!==o&&C===t.length)return n;throw n!==o&&C<t.length&&R({type:"end"}),Z(j,k<t.length?t.charAt(k):null,k<t.length?M(k,k+1):M(k,k))}}}();var t;function r(e){if(e.done)return[`${e.done} [style=filled, fillcolor="#44ff44"]`];let t=e.text.split(" ").join("\n");const r=`${e.needs} [label="${t}"]`;let n=e.steps[0];return[r,`${e.needs} -> ${n} [dir=back]`]}function n(e){document.getElementById("editor").innerText=e}t={translate:function(e){const t=e[0].goal;if(void 0===t)throw new Error("Mikado graph needs exactly one Goal");let n="";for(let t=1;t<e.length;t++){n=`${n}${r(e[t]).join("\n")+"\n"}`}return`digraph G {\n   Goal [peripheries=2, shape=oval, label="${t}", style=filled, fillcolor=lightblue];\n${n}\n}`},translateElement:r};let o="";window.getFile=async function(r){try{let[a]=await window.showOpenFilePicker({types:[{description:"Mikado file",accept:{"text/x-mikado":[".mikado"]}}]});setInterval((()=>{!async function(r,n){const a=await r.getFile();document.title=a.name;const i=await a.text();if(o!==i){o=i;try{const r=(0,e.parse)(i);n((0,t.translate)(r)),document.getElementById("error").innerText=""}catch(e){document.getElementById("error").innerText=e.message}}}(a,r||n)}),500)}catch(e){}};</script> <script src="//d3js.org/d3.v5.min.js"></script> <script src="https://unpkg.com/@hpcc-js/wasm@0.3.11/dist/index.min.js"></script> <script src="https://unpkg.com/d3-graphviz@3.0.5/build/d3-graphviz.js"></script> <div id="example"> <h1>Example text:</h1> <pre style="width:min-content;text-align:left;margin:auto">Goal
    Reduce duplication of switch logic
Goal needs Calls
   Call getpointName(int) replacing both switches
Calls needs AddFunction
  Add getPointName(int) function based on bottom switch
AddFunction needs AddAll
  Add All after top switch
AddAll needs Format
  Format file for readability
AddAll needs DeuceReturn
  Return Deuce if score >= before top switch
Format, DeuceReturn needs Gitignore
  Update .gitignore to reduce workspace clutter
Done: AddAll
Done: Format</pre> </div> <script>const graphviz=d3.select("#graph").graphviz();function render(r){graphviz.renderDot(r)}</script> </body></html>