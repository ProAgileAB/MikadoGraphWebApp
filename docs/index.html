<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Title</title></head><body> <button onclick="getFile(render)">Choose Mikado file (.mikado)</button> <script type="module">var e;e=function(){function e(t,r,n,o){this.message=t,this.expected=r,this.found=n,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){var r,n={literal:function(e){return'"'+a(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function o(e){return e.charCodeAt(0).toString(16).toUpperCase()}function a(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+o(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+o(e)}))}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+o(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+o(e)}))}return"Expected "+function(e){var t,r,o,a=new Array(e.length);for(t=0;t<e.length;t++)a[t]=(o=e[t],n[o.type](o));if(a.sort(),a.length>0){for(t=1,r=1;t<a.length;t++)a[t-1]!==a[t]&&(a[r]=a[t],r++);a.length=r}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(e)+" but "+(((r=t)?'"'+a(r)+'"':"end of input")+" found.")},{SyntaxError:e,parse:function(t,r){r=void 0!==r?r:{};var n,o={},a={Expression:M},i=M,c="Goal",l=k("Goal",!1),u=" needs ",s=k(" needs ",!1),f="Done: ",p=k("Done: ",!1),h="\n",d=k("\n",!1),g=", ",x=k(", ",!1),A=function(e,t){return t},v=/^[a-zA-Z]/,y=z([["a","z"],["A","Z"]],!1,!1),w=/^[()a-zA-Z ">=.+]/,m=z(["(",")",["a","z"],["A","Z"]," ",'"',">","=",".","+"],!1,!1),b=R("whitespace"),F=/^[ \t\n\r]/,C=z([" ","\t","\n","\r"],!1,!1),E=0,$=[{line:1,column:1}],G=0,S=[],j=0;if("startRule"in r){if(!(r.startRule in a))throw new Error("Can't start parsing from rule \""+r.startRule+'".');i=a[r.startRule]}function k(e,t){return{type:"literal",text:e,ignoreCase:t}}function z(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function R(e){return{type:"other",description:e}}function Z(e){var r,n=$[e];if(n)return n;for(r=e-1;!$[r];)r--;for(n={line:(n=$[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return $[e]=n,n}function T(e,t){var r=Z(e),n=Z(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function D(e){E<G||(E>G&&(G=E,S=[]),S.push(e))}function I(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}function M(){var e,t;if(e=[],(t=B())===o&&(t=N())===o&&(t=O()),t!==o)for(;t!==o;)e.push(t),(t=B())===o&&(t=N())===o&&(t=O());else e=o;return e}function B(){var e,r,n;return e=E,t.substr(E,4)===c?(r=c,E+=4):(r=o,0===j&&D(l)),r!==o&&(n=U())!==o?(e,e=r={goal:n}):(E=e,e=o),e}function N(){var e,r,n,a,i;return e=E,r=function(){var e,r,n,a,i,c;if(e=E,(r=P())!==o){for(n=[],a=E,t.substr(E,2)===g?(i=g,E+=2):(i=o,0===j&&D(x)),i!==o&&(c=P())!==o?(a,a=i=A(0,c)):(E=a,a=o);a!==o;)n.push(a),a=E,t.substr(E,2)===g?(i=g,E+=2):(i=o,0===j&&D(x)),i!==o&&(c=P())!==o?(a,a=i=A(0,c)):(E=a,a=o);n!==o?(e,l=r,(u=n).push(l),e=r=u):(E=e,e=o)}else E=e,e=o;var l,u;return e}(),r!==o?(t.substr(E,7)===u?(n=u,E+=7):(n=o,0===j&&D(s)),n!==o&&(a=P())!==o&&(i=U())!==o?(e,e=r={steps:r,needs:a,text:i}):(E=e,e=o)):(E=e,e=o),e}function O(){var e,r,n,a,i;if(e=E,t.substr(E,6)===f?(r=f,E+=6):(r=o,0===j&&D(p)),r!==o)if((n=P())!==o){for(a=[],10===t.charCodeAt(E)?(i=h,E++):(i=o,0===j&&D(d));i!==o;)a.push(i),10===t.charCodeAt(E)?(i=h,E++):(i=o,0===j&&D(d));a!==o?(e,e=r={done:n}):(E=e,e=o)}else E=e,e=o;else E=e,e=o;return e}function P(){var e,r,n;if(e=E,r=[],v.test(t.charAt(E))?(n=t.charAt(E),E++):(n=o,0===j&&D(y)),n!==o)for(;n!==o;)r.push(n),v.test(t.charAt(E))?(n=t.charAt(E),E++):(n=o,0===j&&D(y));else r=o;return r!==o&&(e,r=r.join("")),e=r}function U(){var e,r,n,a,i;if(e=E,10===t.charCodeAt(E)?(r=h,E++):(r=o,0===j&&D(d)),r!==o)if(n=function(){var e,r;j++,e=[],F.test(t.charAt(E))?(r=t.charAt(E),E++):(r=o,0===j&&D(C));for(;r!==o;)e.push(r),F.test(t.charAt(E))?(r=t.charAt(E),E++):(r=o,0===j&&D(C));j--,e===o&&(r=o,0===j&&D(b));return e}(),n!==o){if(a=[],w.test(t.charAt(E))?(i=t.charAt(E),E++):(i=o,0===j&&D(m)),i!==o)for(;i!==o;)a.push(i),w.test(t.charAt(E))?(i=t.charAt(E),E++):(i=o,0===j&&D(m));else a=o;a!==o?(10===t.charCodeAt(E)?(i=h,E++):(i=o,0===j&&D(d)),i!==o?(e,e=r=a.join("")):(E=e,e=o)):(E=e,e=o)}else E=e,e=o;else E=e,e=o;return e}if((n=i())!==o&&E===t.length)return n;throw n!==o&&E<t.length&&D({type:"end"}),I(S,G<t.length?t.charAt(G):null,G<t.length?T(G,G+1):T(G,G))}}}();var t;function r(e){if(e.done)return[`${e.done} [style=filled, fillcolor=green]`];const t=`${e.needs} [label="${e.text}"]`;let r="Goal"===e.steps[0]?"end":e.steps[0];return[t,`${e.needs} -> ${r} [dir=back]`]}function n(e){document.getElementById("editor").innerText=e}t={translate:function(e){const t=e[0].goal;if(void 0===t)return'digraph G {\n   end [shape=tripleoctagon, label="Need a Goal node!", style=filled, fillcolor=red];\n}\n';let n="";for(let t=1;t<e.length;t++){n=`${n}${r(e[t]).join("\n")+"\n"}`}return`digraph G {\n   end [peripheries=2, shape=oval, label="${t}", style=filled, fillcolor=lightblue];\n${n}\n}`},translateElement:r},window.getFile=async function(r){try{let[o]=await window.showOpenFilePicker();setInterval((()=>{!async function(r,n){let o=await r.getFile(),a=await o.text();const i=(0,e.parse)(a);n((0,t.translate)(i))}(o,r||n)}),500)}catch(e){}};</script> <script src="//d3js.org/d3.v5.min.js"></script> <script src="https://unpkg.com/@hpcc-js/wasm@0.3.11/dist/index.min.js"></script> <script src="https://unpkg.com/d3-graphviz@3.0.5/build/d3-graphviz.js"></script> <div id="graph" style="text-align:center"></div> <script>const graphviz=d3.select("#graph").graphviz();function render(r){graphviz.renderDot(r)}</script> </body></html>